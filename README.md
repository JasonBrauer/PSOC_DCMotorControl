# Motor_Control_Experiment
Experiment to implement a motor controller from a Cypress Semiconductor PSOC5 and basic electrical components

## Current_Circuit_Design
![current circuit](./images/CircuitDesign_20211214.png)

## Speed_From_BackEmf
A simple motor can be thought of as an inductor, resistor and back emf voltage source all in series. The voltages from the inductor, resistor, and back emf all oppose the supplied voltage to the motor.

The opposing voltage of the inductor is due to a varying current in time:

V_L = L * di/dt 

Once the current reaches steady state, di/dt becomes zero and therefore V_L becomes zero. 

(insert timeline of trasient V_L with screenshot from nscope)

The ground path from the motor can be removed allowing the voltage of the motor circuit to be measured. **This will cause a short transient change in the inductor current and voltage - is this the case since there isn't any ground?**

Waiting long enough for the current change to reach steady state allows the measured voltage of the circuit become:

V_external - V_emf - V_R = V_measured

V_emf = V_measured - V_external + V_R

Then the speed constant of the motor (Ke) - rated voltage of the motor over the no-load speed of the motor - can be used in combination with the back emf voltage to calculate the speed. 

motor_speed = V_emf / K_e


## Manual_Rotary_Encoder
Inputs read with comparators to convert analog signals from the encoder to digital signals for use in the controller.

Sample and hold devices used with 1kHz sample rate to filter out high frequency analog noise generated by the mechanical contacts within the encoder.

![manual encoder signals noisy](./images/manualencoder_signals_noisy_20211214.png)

### Issues
At a frequency of about 1/10 notches, reading the encoder registers a positive increment instead of negative when rotating CCW. Haven't determined the source of the problem, but it could be because the falling edge of the 'lead' signal occurs at nearly the same instant or possible even behind the trailing signal.The interrupt service routine that sample the encoder signals triggers on the falling edge of the red signal below.

![manual encoder signals](./images/manualencoder_signals_20211206.png)